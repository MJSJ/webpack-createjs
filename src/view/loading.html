<script type="text/javascript">
	
	var html = document.documentElement;
	var windowWidth = html.clientWidth;
	html.style.fontSize = windowWidth / 6.4 + 'px';
	 
	//transform缩放
	(function(window){
		function pageUtil(selector){
		  this.ele = document.querySelectorAll(selector)[0];
		  this.scaleNum = document.documentElement.clientWidth/640;
		  return this;
		}
		pageUtil.prototype.response = function(selector){
		      this.ele.style.cssText = "-webkit-transform-origin: 0 0 0px; -webkit-transform: scale("+this.scaleNum+");position: absolute;width:640px;height:1136px";
		      return this;
		}
		pageUtil.prototype.rotate = function(){
		  this.ele["style"]["cssText"] = "width: "+1136+"px;height: "+640+"px;transform:rotate(90deg) translate(-50%,-50%);"+
		  "transform-origin:0 0; position: absolute; top: 50%; left: 50%;"
		  return this;
		}
		window.pageUtil = pageUtil
	})(window);

	(function(root, factory) {
		if (typeof define === 'function' && define.amd) {
		  //AMD
		  define(factory);
		} else if (typeof exports === 'object') {
		  //Node, CommonJS之类的
		  module.exports = factory();
		} else {
		  //浏览器全局变量(root 即 window)
		  root.resLoader = factory(root);
		}
	}(this, function() {
	var isFunc = function(f) {
	    return typeof f === 'function';
	  }
	  //构造器函数
	function resLoader(config) {
	  this.option = {
	    resourceType: 'image', //资源类型，默认为图片
	    baseUrl: './', //基准url
	    resources: [], //资源路径数组
	    onStart: null, //加载开始回调函数，传入参数total
	    onProgress: null, //正在加载回调函数，传入参数currentIndex, total
	    onComplete: null //加载完毕回调函数，传入参数total
	  }
	  if (config) {
	    for (i in config) {
	      this.option[i] = config[i];
	    }
	  } else {
	    alert('参数错误！');
	    return;
	  }
	  this.status = 0; //加载器的状态，0：未启动   1：正在加载   2：加载完毕
	  this.total = this.option.resources.length || 0; //资源总数
	  this.currentIndex = 0; //当前正在加载的资源索引
	};

	resLoader.prototype.start = function() {
	  this.status = 1;
	  var _this = this;
	  var baseUrl = this.option.baseUrl;
	  for (var i = 0, l = this.option.resources.length; i < l; i++) {
	    var r = this.option.resources[i],
	      url = '';
	    if (r.indexOf('http://') === 0 || r.indexOf('https://') === 0) {
	      url = r;
	    } else {
	      url = baseUrl + r;
	    }

	    var image = new Image();
	    image.onload = function() {
	      _this.loaded();
	    };
	    image.onerror = function() {
	      _this.loaded();
	    };
	    image.src = url;
	  }
	  if (isFunc(this.option.onStart)) {
	    this.option.onStart(this.total);
	  }
	}

	resLoader.prototype.loaded = function() {
	  if (isFunc(this.option.onProgress)) {
	    this.option.onProgress(++this.currentIndex, this.total);
	  }
	  //加载完毕
	  if (this.currentIndex === this.total) {
	    if (isFunc(this.option.onComplete)) {
	      this.option.onComplete(this.total);
	    }
	  }
	}

	//暴露公共方法
	return resLoader;
	}));
</script>

<div class="loading">
	<svg class="icon-loading" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64" width="64" height="64" fill="black">
	  <circle transform="translate(8 0)" cx="0" cy="32" r="0"> 
	    <animate attributeName="r" values="0; 8; 0; 0" dur="1.2s" repeatCount="indefinite" begin="0"
	      keytimes="0;0.2;0.7;1" keySplines="0.2 0.2 0.4 0.8;0.2 0.6 0.4 0.8;0.2 0.6 0.4 0.8" calcMode="spline" />
	  </circle>
	  <circle transform="translate(28 0)" cx="0" cy="32" r="0"> 
	    <animate attributeName="r" values="0; 8; 0; 0" dur="1.2s" repeatCount="indefinite" begin="0.3"
	      keytimes="0;0.2;0.7;1" keySplines="0.2 0.2 0.4 0.8;0.2 0.6 0.4 0.8;0.2 0.6 0.4 0.8" calcMode="spline" />
	  </circle>
	  <circle transform="translate(48 0)" cx="0" cy="32" r="0"> 
	    <animate attributeName="r" values="0; 8; 0; 0" dur="1.2s" repeatCount="indefinite" begin="0.6"
	      keytimes="0;0.2;0.7;1" keySplines="0.2 0.2 0.4 0.8;0.2 0.6 0.4 0.8;0.2 0.6 0.4 0.8" calcMode="spline" />
	  </circle>
	</svg>

	<div class="pace">
		<div class="pace-progress"></div>
	</div>
</div>

<script type="text/javascript">
	var loader = new resLoader({
	    resources: [
			"http://news.sohu.com/upload/yursile/dushue/img/shop11.png",
	    ],
	    onStart: function(total) {},
	    onProgress: function(current, total) {
	      var percent = parseInt(current / total * 100) + '%';
	      document.querySelector('.pace-progress').innerHTML=percent;
	    },
	    onComplete: function(total) {
	     
	      // initView();
	      setTimeout(function(){
	      	 document.querySelector('.loading').style.display="none";
	      },3000);
	    }
  	});
  loader.start();
</script>